---
apiVersion: batch/v1
kind: Job
metadata:
  name: create-iceberg-tables
spec:
  template:
    spec:
      containers:
        - name: create-iceberg-tables
          image: "oci.stackable.tech/sdp/trino-cli:{{ test_scenario['values']['trino-l'] }}-stackable0.0.0-dev"
          command:
            - bash
            - -euo
            - pipefail
            - -c
            - |
              cat << 'EOF' | ./trino-cli --server https://trino-coordinator:8443 --insecure --user admin
              CREATE SCHEMA IF NOT EXISTS lakehouse.test;
              CREATE TABLE IF NOT EXISTS lakehouse.test.greetings (hello varchar);
              EOF
      restartPolicy: OnFailure
